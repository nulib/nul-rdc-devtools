#!/bin/bash

secrets=$(aws secretsmanager get-secret-value --secret-id dev-environment/db | jq '.SecretString | fromjson')

get_parameter() {
  jq -r ".$1" <<< $secrets
}

DEV_ENV=${DEV_ENV:-dev}
PGPASSWORD=$(get_parameter password) psql -h $(get_parameter host) -p $(get_parameter port) -U $(get_parameter user) ${DEV_PREFIX}-${DEV_ENV}-meadow
